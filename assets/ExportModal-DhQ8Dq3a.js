import{b as B,j as e,S as G,f as V,r as g,u as T,L as C,g as w,t as q,d as J,M as K,e as H,h as W,i as Y,D as Q,k as X}from"./index-CIMXU-Ls.js";import{C as Z}from"./copy-DWyScT85.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=B("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ee=({products:p})=>e.jsxs("div",{className:"font-sans text-gray-800",children:[e.jsxs("header",{className:"text-center mb-8 border-b-2 border-purple-600 pb-4",children:[e.jsx(G,{className:"mx-auto h-12 w-12 text-purple-600"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mt-2",children:"Alquima Mizu"}),e.jsx("p",{className:"text-lg text-purple-700",children:"Catálogo de Productos"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.map(c=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden flex flex-col shadow-md",children:[e.jsx("div",{className:"w-full h-40 bg-gray-100 flex items-center justify-center",children:c.imageUrls[0]&&e.jsx("img",{src:c.imageUrls[0],alt:c.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-3 flex flex-col flex-grow",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-600 font-semibold uppercase",children:c.category}),e.jsx("h3",{className:"text-base font-bold text-gray-900 mt-1",children:c.title}),e.jsx("p",{className:"text-xs text-gray-600 mt-2 flex-grow",children:c.details})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium text-sm",children:"Precio:"}),e.jsx("span",{className:"font-semibold text-green-700 text-base",children:V(c,{onlyAvailable:!0})})]})})]})]},c.id))}),e.jsxs("footer",{className:"text-center mt-12 pt-4 border-t border-gray-300",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Catálogo generado el ",new Date().toLocaleDateString("es-ES")]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Alquima Mizu - Todos los derechos reservados."})]})]}),te={json:"Exportar a JSON",markdown:"Exportar a Markdown",catalog:"Vista Previa del Catálogo",csv:"Exportar a CSV / Excel"},ae=({isOpen:p,onClose:c,format:n,products:u,ignoredProductIds:h})=>{const[m,A]=g.useState("Todas"),[v,M]=T(C.OMITTED_HINTS,[]),[b,f]=T(C.CATALOG_SELECTED_HINTS,[]),[j,N]=g.useState(""),[P,S]=g.useState(!1),x=g.useMemo(()=>Array.from(new Set(u.flatMap(t=>t.imageHint||[]).filter(Boolean))),[u]);g.useEffect(()=>{p&&n==="catalog"&&localStorage.getItem(C.CATALOG_SELECTED_HINTS)===null&&f(x)},[p,n,x,f]);const k=g.useMemo(()=>{const t=u.filter(s=>s.variants.some(l=>l.stock>0)&&!h.includes(s.id));return n==="markdown"?m==="Todas"?t:t.filter(s=>s.imageHint&&s.imageHint.includes(m)):n==="catalog"?b.length===0?[]:t.filter(s=>(s.imageHint||[]).some(l=>b.includes(l))):t},[u,h,n,m,b]),E=g.useMemo(()=>u.filter(t=>!h.includes(t.id)),[u,h]);g.useEffect(()=>{if(p)if(n==="json"){const l={placeholderImages:[...u].sort((r,a)=>{const i=w(r),o=w(a);return i===-1&&o!==-1?-1:i!==-1&&o===-1?1:i===-1&&o===-1?r.title.localeCompare(a.title):i-o}).filter(r=>r.id==="banner"?!0:r.imageUrls&&r.imageUrls.length>0&&r.imageUrls[0].trim()!=="").map(q)};N(JSON.stringify(l,null,2))}else if(n==="markdown"){let t="";const s=k.reduce((r,a)=>((a.imageHint&&a.imageHint.length>0?a.imageHint:["Otros"]).forEach(o=>{r[o]||(r[o]=[]),r[o].push(a)}),r),{}),l=r=>r.sort((a,i)=>{const o=w(a),d=w(i);return o===-1&&d!==-1?-1:o!==-1&&d===-1?1:o===-1&&d===-1?a.title.localeCompare(i.title):o-d}).map(a=>{const i=a.variants.filter(d=>d.stock>0&&d.price&&d.price>0);if(i.length===0)return`- ${a.title}: Agotado`;let o=`- ${a.title}:`;if(i.length===1)o+=` ${H(i[0],{markdown:!0})}`;else{const d=i.sort((y,R)=>y.price-R.price).map(y=>`  * ${y.name}: ${H(y,{markdown:!0})}`).join(`
`);o+=`
${d}`}return o}).join(`
`);m!=="Todas"?t=`*${m}*
`+l(s[m]||[]):t=Object.entries(s).sort(([r],[a])=>r.localeCompare(a)).filter(([r])=>!v.includes(r)).map(([r,a])=>`
*${r}*
${l(a)}`).join(`
`),N(t.trim())}else n==="csv"&&N(J(E))},[p,n,u,k,h,m,v,E]);const z=g.useCallback(()=>{navigator.clipboard.writeText(j).then(()=>{S(!0),setTimeout(()=>S(!1),2e3)})},[j]),D=()=>window.print(),O=()=>{const t=new Blob([j],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`alquima-mizu-export-${new Date().toISOString().slice(0,10)}.csv`,l.click(),URL.revokeObjectURL(s),l.remove()},F=t=>M(s=>s.includes(t)?s.filter(l=>l!==t):[...s,t]),$=t=>f(s=>s.includes(t)?s.filter(l=>l!==t):[...s,t]),U=n==="markdown"&&x.length>0,I=n==="catalog"&&x.length>0,_=()=>{switch(n){case"catalog":return e.jsxs("div",{className:"bg-gray-700 w-full h-full overflow-auto p-4 md:p-8",children:[e.jsxs("div",{className:"no-print mx-auto max-w-4xl mb-4 space-y-4",children:[e.jsxs("button",{onClick:D,className:"flex items-center justify-center gap-2 w-full bg-brand-blue hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-transform transform hover:scale-105",children:[e.jsx(X,{size:18}),e.jsx("span",{children:"Imprimir / Guardar como PDF"})]}),e.jsx("div",{className:"md:hidden p-3 text-center text-xs bg-yellow-900/50 text-yellow-300 rounded-lg border border-yellow-700",children:"Para una mejor experiencia de impresión, por favor usa una computadora. En móvil, puedes intentar usar la función de 'captura de pantalla con desplazamiento' de tu dispositivo."}),I&&e.jsxs("details",{className:"p-3 bg-gray-800/50 rounded-lg border border-gray-600",open:!0,children:[e.jsxs("summary",{className:"cursor-pointer font-medium text-gray-300 flex items-center gap-2",children:[e.jsx(L,{size:16}),"Filtrar por Serie (selección múltiple)"]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-sm",children:[e.jsx("button",{onClick:()=>f(x),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 rounded",children:"Todos"}),e.jsx("button",{onClick:()=>f([]),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 rounded",children:"Ninguno"})]}),e.jsx("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 max-h-40 overflow-y-auto",children:x.map(t=>e.jsxs("label",{className:"flex items-center gap-2 text-sm p-1 rounded hover:bg-gray-700/50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b.includes(t),onChange:()=>$(t),className:"form-checkbox h-4 w-4 rounded bg-gray-800 border-gray-600 text-purple-500 focus:ring-purple-600"}),t]},t))})]})]}),e.jsx("div",{id:"catalog-to-print",className:"bg-white text-black p-8 md:p-12 rounded-lg shadow-2xl max-w-4xl mx-auto my-8",children:e.jsx(ee,{products:k})})]});case"csv":return e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("p",{className:"mb-6 text-gray-300",children:"Se generará un archivo CSV con todos los productos y sus variantes. Este archivo es compatible con Excel, Google Sheets y otras hojas de cálculo."}),e.jsxs("button",{onClick:O,className:"flex items-center justify-center gap-3 w-full max-w-xs mx-auto bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 shadow-lg",children:[e.jsx(Q,{size:20}),"Descargar Archivo .csv"]})]});default:return e.jsxs("div",{className:"p-6",children:[U&&e.jsxs("div",{className:"no-print mb-4 p-3 bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("label",{htmlFor:"hint-filter",className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-2",children:[e.jsx(L,{size:16}),"Filtrar por Serie (imageHint)"]}),e.jsx("select",{id:"hint-filter",value:m,onChange:t=>A(t.target.value),className:"block w-full bg-gray-900 border border-gray-600 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",children:["Todas",...x].map(t=>e.jsx("option",{value:t,children:t},t))})]}),n==="markdown"&&m==="Todas"&&x.length>1&&e.jsxs("details",{className:"no-print mb-4 text-sm",children:[e.jsxs("summary",{className:"cursor-pointer text-gray-400 hover:text-white flex items-center gap-1",children:[e.jsx(W,{size:16,className:"transition-transform transform details-open:rotate-180"}),"Omitir Series del Markdown"]}),e.jsx("div",{className:"mt-2 p-3 bg-gray-700/50 rounded-lg border border-gray-600 max-h-32 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:x.map(t=>e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:v.includes(t),onChange:()=>F(t),className:"form-checkbox h-4 w-4 rounded bg-gray-800 border-gray-600 text-purple-500 focus:ring-purple-600"}),t]},t))})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-gray-900 text-sm p-4 rounded-lg overflow-auto max-h-96 border border-gray-700",children:e.jsx("code",{children:j})}),e.jsx("button",{onClick:z,className:"absolute top-2 right-2 p-2 bg-gray-700 hover:bg-gray-600 rounded-md transition-colors",children:P?e.jsx(Y,{size:16,className:"text-green-400"}):e.jsx(Z,{size:16})})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:n==="json"?"Listo para pegar en placeholder-images.json":"Formato optimizado para WhatsApp/Instagram."})]})}};return e.jsx(K,{isOpen:p,onClose:c,title:te[n],size:n==="catalog"?"full":"lg",children:_()})};export{ae as default};
